syntax = "proto3";
  
package shared.service;


option go_package = "github.com/usmonnuriddinzoda/sharedpb/service/authpb";

// Сервис для auth.
service AuthService {
  rpc LoginCustomer(LoginCustomerRequest) returns (LoginCustomerResponse);
  rpc LoginUser(LoginUserRequest) returns (LoginUserResponse);
  rpc SendOtp(SendOtpRequest) returns (SendOtpResponse);
  rpc ConfirmOtp(ConfirmOtpRequest) returns (ConfirmOtpResponse);
  rpc RefreshToken(RefreshTokenRequest) returns (RefreshTokenResponse);
}

message AuthServiceError {
  int64 err_code = 1;
  string err_description = 2;
}

message LoginCustomerRequest {
  string phone = 1;
}

message LoginCustomerResponse {
  string requestId = 2;
  AuthServiceError error = 3;
}

message SendOtpRequest {
  string requestId = 1;
}

message SendOtpResponse {
  int32  Expiration = 1;
  int32  TotalSent  = 2;
  AuthServiceError error = 4;
}

message ConfirmOtpRequest {
  string  otp =  1;
  string requestId  = 2;
  string ip_address = 3;   // IP клиента (если нужно фиксировать)
  string user_agent = 4;   // User-Agent клиента
}

message Token {
  string AccessToken = 1;
  string RefreshToken = 2;
}

message ConfirmOtpResponse {
  Token Token = 1;
  string TypeCustomer = 2;
  AuthServiceError error = 3;
}

message LoginUserRequest{
  string username = 1;
  string password = 2;
}

message LoginUserResponse{
  string requestId = 1;
  AuthServiceError error = 2;
}

message RefreshTokenRequest {
  string refreshToken = 1;
}
message RefreshTokenResponse {
  Token token = 1;
  AuthServiceError error = 2;
}