syntax = "proto3";
  
package shared.service;


option go_package = "github.com/usmonnuriddinzoda/sharedpb/service/authpb";

// Сервис для auth.
service AuthService {
  rpc LoginCustomer(LoginCustomerReq) returns (LoginCustomerResp);
  rpc LoginUser(LoginUserReq) returns (LoginUserResp);
  rpc SendOtp(SendOtpReq) returns (SendOtpResp);
  rpc ConfirmOtp(ConfirmOtpReq) returns (ConfirmOtpResp);
  rpc RefreshToken(RefreshTokenReq) returns (RefreshTokenResp);
}

message AuthServiceError {
  int64 err_code = 1;
  string err_description = 2;
}

message LoginCustomerReq {
  string phone = 1;
}

message LoginCustomerResp {
  string requestId = 2;
  AuthServiceError error = 3;
}

message SendOtpReq {
  string requestId = 1;
}

message SendOtpResp {
  int32  Expiration = 1;
  int32  TotalSent  = 2;
  AuthServiceError error = 4;
}

message ConfirmOtpReq {
  string  otp =  1;
  string requestId  = 2;
  string ip_address = 3;   // IP клиента (если нужно фиксировать)
  string user_agent = 4;   // User-Agent клиента
}

message Token {
  string AccessToken = 1;
  string RefreshToken = 2;
}

message ConfirmOtpResp {
  Token Token = 1;
  string TypeCustomer = 2;
  AuthServiceError error = 3;
}

message LoginUserReq{
  string username = 1;
  string password = 2;
}

message LoginUserResp{
  string requestId = 1;
  AuthServiceError error = 2;
}

message RefreshTokenReq {
  string refreshToken = 1;
}
message RefreshTokenResp {
  Token token = 1;
  AuthServiceError error = 2;
}